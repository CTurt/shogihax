#define framebuffer_set (*(volatile void **)0xA4400004)

#define static_center_draw(framebuffer, y, size, spacing, s) draw(framebuffer, (640 - (sizeof(s) - 1) * (8 + spacing) * size) / 2, y, size, spacing, s)

static const unsigned char font[] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x00, 0x18, 0x00, 0x00, 0x66, 0x66, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x28, 0x28, 0x7e, 0x14, 0x7e, 0x14, 0x00, 0x00, 0x3c, 0x56, 0x3e, 0x7c, 0x6a, 0x3c, 0x08, 0x00, 0x44, 0x2a, 0x14, 0x28, 0x54, 0x22, 0x00, 0x00, 0x0c, 0x12, 0x4c, 0x32, 0x32, 0x4c, 0x00, 0x00, 0x18, 0x18, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x18, 0x0c, 0x0c, 0x0c, 0x0c, 0x18, 0x30, 0x0c, 0x18, 0x30, 0x30, 0x30, 0x30, 0x18, 0x0c, 0x18, 0x7e, 0x18, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x7e, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x08, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x40, 0x60, 0x30, 0x18, 0x0c, 0x06, 0x02, 0x00, 0x5c, 0x26, 0x52, 0x4a, 0x64, 0x3a, 0x00, 0x00, 0x18, 0x1c, 0x18, 0x18, 0x18, 0x3c, 0x00, 0x00, 0x1c, 0x32, 0x30, 0x18, 0x0c, 0x7e, 0x00, 0x00, 0x3c, 0x62, 0x38, 0x60, 0x62, 0x3c, 0x00, 0x00, 0x30, 0x38, 0x34, 0x32, 0x7e, 0x30, 0x00, 0x00, 0x7e, 0x06, 0x3e, 0x60, 0x62, 0x3c, 0x00, 0x00, 0x3c, 0x06, 0x3e, 0x66, 0x66, 0x3c, 0x00, 0x00, 0x7e, 0x66, 0x30, 0x7c, 0x18, 0x18, 0x00, 0x00, 0x3c, 0x66, 0x3c, 0x66, 0x66, 0x3c, 0x00, 0x00, 0x3c, 0x66, 0x66, 0x7c, 0x60, 0x3c, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x18, 0x18, 0x08, 0x00, 0x00, 0x60, 0x18, 0x06, 0x18, 0x60, 0x00, 0x00, 0x00, 0x00, 0x7e, 0x00, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x06, 0x18, 0x60, 0x18, 0x06, 0x00, 0x00, 0x3c, 0x66, 0x66, 0x30, 0x18, 0x00, 0x18, 0x00, 0x3e, 0x41, 0x5d, 0x55, 0x7d, 0x02, 0x7c, 0x00, 0x18, 0x3c, 0x24, 0x7e, 0x66, 0x66, 0x00, 0x00, 0x3e, 0x66, 0x3e, 0x66, 0x66, 0x3e, 0x00, 0x00, 0x3c, 0x66, 0x06, 0x46, 0x7e, 0x3c, 0x00, 0x00, 0x3e, 0x66, 0x66, 0x66, 0x7e, 0x3e, 0x00, 0x00, 0x7e, 0x06, 0x3e, 0x06, 0x7e, 0x7e, 0x00, 0x00, 0x7e, 0x06, 0x3e, 0x06, 0x06, 0x06, 0x00, 0x00, 0x3c, 0x66, 0x06, 0x76, 0x66, 0x3c, 0x00, 0x00, 0x66, 0x66, 0x7e, 0x66, 0x66, 0x66, 0x00, 0x00, 0x7e, 0x18, 0x18, 0x18, 0x7e, 0x7e, 0x00, 0x00, 0x7c, 0x30, 0x30, 0x32, 0x3e, 0x1c, 0x00, 0x00, 0x66, 0x36, 0x1e, 0x1e, 0x36, 0x66, 0x00, 0x00, 0x06, 0x06, 0x06, 0x06, 0x7e, 0x7e, 0x00, 0x00, 0x42, 0x66, 0x7e, 0x5a, 0x5a, 0x42, 0x00, 0x00, 0x62, 0x66, 0x6e, 0x7e, 0x76, 0x66, 0x00, 0x00, 0x3c, 0x66, 0x66, 0x66, 0x7e, 0x3c, 0x00, 0x00, 0x3e, 0x66, 0x7e, 0x3e, 0x06, 0x06, 0x00, 0x00, 0x3c, 0x66, 0x46, 0x56, 0x7e, 0x3c, 0x40, 0x00, 0x3e, 0x66, 0x7e, 0x3e, 0x36, 0x66, 0x00, 0x00, 0x3c, 0x46, 0x3e, 0x7c, 0x62, 0x3c, 0x00, 0x00, 0x7e, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x66, 0x66, 0x66, 0x66, 0x7e, 0x3c, 0x00, 0x00, 0x66, 0x66, 0x66, 0x24, 0x3c, 0x18, 0x00, 0x00, 0x42, 0x5a, 0x5a, 0x7e, 0x66, 0x42, 0x00, 0x00, 0x66, 0x3c, 0x18, 0x3c, 0x66, 0x42, 0x00, 0x00, 0x66, 0x66, 0x3c, 0x18, 0x18, 0x18, 0x00, 0x00, 0x7e, 0x30, 0x18, 0x0c, 0x7e, 0x7e, 0x00, 0x00, 0x38, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x38, 0x02, 0x06, 0x0c, 0x18, 0x30, 0x60, 0x40, 0x00, 0x1c, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x1c, 0x18, 0x24, 0x42, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x18, 0x18, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1c, 0x26, 0x26, 0x5c, 0x00, 0x00, 0x0c, 0x0c, 0x3c, 0x4c, 0x4c, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x06, 0x46, 0x3c, 0x00, 0x00, 0x30, 0x30, 0x3c, 0x32, 0x32, 0x5c, 0x00, 0x00, 0x00, 0x00, 0x1c, 0x16, 0x4e, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x38, 0x4c, 0x0c, 0x3e, 0x0c, 0x0c, 0x00, 0x00, 0x5c, 0x66, 0x66, 0x7c, 0x62, 0x3c, 0x06, 0x06, 0x3e, 0x46, 0x46, 0x46, 0x00, 0x00, 0x0c, 0x00, 0x0c, 0x0c, 0x2c, 0x18, 0x00, 0x00, 0x60, 0x00, 0x60, 0x60, 0x60, 0x60, 0x62, 0x3c, 0x06, 0x26, 0x16, 0x1e, 0x26, 0x46, 0x00, 0x00, 0x0c, 0x0c, 0x0c, 0x0c, 0x2c, 0x18, 0x00, 0x00, 0x00, 0x00, 0x2a, 0x56, 0x56, 0x46, 0x00, 0x00, 0x00, 0x00, 0x3a, 0x46, 0x46, 0x46, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x46, 0x46, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x3a, 0x66, 0x66, 0x3e, 0x06, 0x06, 0x00, 0x00, 0x2c, 0x32, 0x32, 0x3c, 0x70, 0x30, 0x00, 0x00, 0x3a, 0x46, 0x06, 0x06, 0x00, 0x00, 0x00, 0x3c, 0x46, 0x18, 0x62, 0x3c, 0x00, 0x00, 0x0c, 0x0c, 0x1e, 0x0c, 0x4c, 0x38, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0x66, 0x5c, 0x00, 0x00, 0x00, 0x00, 0x46, 0x46, 0x2c, 0x18, 0x00, 0x00, 0x00, 0x00, 0x42, 0x5a, 0x5a, 0x34, 0x00, 0x00, 0x00, 0x00, 0x46, 0x2c, 0x18, 0x66, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0x66, 0x7c, 0x62, 0x3c, 0x00, 0x00, 0x7e, 0x30, 0x0c, 0x7e, 0x00, 0x00, 0x38, 0x0c, 0x0c, 0x18, 0x18, 0x0c, 0x0c, 0x38, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x1c, 0x30, 0x30, 0x18, 0x18, 0x30, 0x30, 0x1c, 0x00, 0x00, 0x0e, 0x5a, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

char framebufferMemory[2 * 640 * 480 * 2];

static void draw(unsigned short *framebuffer, int x, int y, int size, int spacing, char *s) {
	while(*s) {
		unsigned char c = *s;
		if(c > 127) c = 0;

		int xi, yi;
		for(yi = 0; yi < 8; yi++) {
			for(xi = 0; xi < 8; xi++) {
				int xj, yj;
				for(yj = 0; yj < size; yj++) {
					for(xj = 0; xj < size; xj++) {
						if(((font[c * 8 + (xi + yi * 8) / 8] >> xi)) & 1) framebuffer[x + xi * size + xj + (y + yi * size + yj) * 640] = 0xffff;
					}
				}
			}
		}

		x += (8 + spacing) * size;
		s++;
	}
}
